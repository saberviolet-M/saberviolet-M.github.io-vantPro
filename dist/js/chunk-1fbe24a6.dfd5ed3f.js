(window.webpackJsonp = window.webpackJsonp || []).push([['chunk-1fbe24a6'], { '3afc': function(t, e, n) { 'use strict'; n('e2e6') }, '6ba8': function(t, e, n) {}, '78d2': function(t, e, n) { 'use strict'; n('6ba8') }, 9332: function(t, e, n) { 'use strict'; n('d1d2') }, a706: function(t, e, n) { 'use strict'; n.r(e); var a = function() { var t = this; var e = t.$createElement; var n = t._self._c || e; return n('div', { staticClass: 'article-container' }, [n('van-nav-bar', { attrs: { fixed: '', 'left-arrow': '', title: '文章详情' }, on: { 'click-left': function(e) { return t.$router.back() } } }), t.loading ? n('van-loading', { staticClass: 'article-loading' }) : n('div', { staticClass: 'detail' }, [n('h3', { staticClass: 'title' }, [t._v(t._s(t.article.title))]), n('div', { staticClass: 'author' }, [n('van-image', { attrs: { src: t.article.aut_photo, round: '', width: '1rem', height: '1rem', fit: 'fill' } }), n('div', { staticClass: 'text' }, [n('p', { staticClass: 'name' }, [t._v(t._s(t.article.aut_name))]), n('p', { staticClass: 'time' }, [t._v(t._s(t._f('relative')(t.article.pubdate)))])]), n('van-button', { attrs: { round: '', size: 'small', type: 'info' }, on: { click: t.toggleFollow } }, [t._v(' ' + t._s(t.article.is_followed ? '取关' : '+ 关注') + ' ')])], 1), n('div', { staticClass: 'content', domProps: { innerHTML: t._s(t.article.content) } }), n('van-divider', [t._v('END')]), n('div', { staticClass: 'zan' }, [n('van-button', { attrs: { round: '', size: 'small', hairline: '', type: 'primary', plain: '', icon: t.article.attitude === 1 ? 'good-job' : 'good-job-o' }, on: { click: t.toggleLike } }, [t._v(' ' + t._s(t.article.attitude === 1 ? '取消点赞' : '点赞') + ' ')]), t._v(' '), n('van-button', { attrs: { round: '', size: 'small', hairline: '', type: 'danger', plain: '', icon: 'delete' }, on: { click: t.toggleDislike } }, [t._v(' ' + t._s(t.article.attitude === 0 ? '取消不喜欢' : '不喜欢') + ' ')])], 1)], 1), n('article-comment', { attrs: { articleId: t.id } })], 1) }; var r = []; var i = n('1da1'); var c = (n('d3b7'), n('25f0'), n('96cf'), n('2423')); var o = n('c24f'); var s = function() { var t = this; var e = t.$createElement; var n = t._self._c || e; return n('div', { staticClass: 'article-comments' }, [n('van-list', { attrs: { finished: t.finished, 'finished-text': '没有更多了' }, on: { load: t.onLoad }, model: { value: t.loading, callback: function(e) { t.loading = e }, expression: 'loading' } }, t._l(t.list, function(e, a) { return n('van-cell', { key: a }, [n('van-image', { staticStyle: { 'margin-right': '10px' }, attrs: { slot: 'icon', round: '', width: '30', height: '30', src: e.aut_photo }, slot: 'icon' }), n('span', { staticStyle: { color: '#466b9d' }, attrs: { slot: 'title' }, slot: 'title' }, [t._v(t._s(e.aut_name))]), n('div', { attrs: { slot: 'label' }, slot: 'label' }, [n('p', { staticStyle: { color: '#363636' } }, [t._v(t._s(e.content))]), n('p', [n('span', { staticStyle: { 'margin-right': '10px' } }, [t._v(t._s(t._f('relative')(e.pubdate)))]), n('van-button', { attrs: { size: 'mini', type: 'default' }, on: { click: function(n) { return t.clickShowReply(e) } } }, [t._v(' 回复 ')])], 1)]), n('van-icon', { attrs: { slot: 'right-icon', name: e.is_liking ? 'like' : 'like-o' }, on: { click: function(n) { return t.toggleCommentLike(e) } }, slot: 'right-icon' })], 1) }), 1), n('van-cell-group', { staticClass: 'publish-wrap' }, [n('van-field', { attrs: { clearable: '', placeholder: '请输入评论内容' }, model: { value: t.content, callback: function(e) { t.content = typeof e === 'string' ? e.trim() : e }, expression: 'content' } }, [n('van-button', { attrs: { slot: 'button', size: 'mini', type: 'info' }, on: { click: t.addComment }, slot: 'button' }, [t._v('发布 ')])], 1), n('van-popup', { style: { height: '85%' }, attrs: { round: '', position: 'bottom' }, model: { value: t.isShowReply, callback: function(e) { t.isShowReply = e }, expression: 'isShowReply' } }, [t.isShowReply ? n('comment-reply', { attrs: { 'article-id': t.articleId, currentComment: t.currentComment }, on: { close: function(e) { t.isShowReply = !1 } } }) : t._e()], 1)], 1)], 1) }; var l = []; var u = n('2909'); var d = (n('99af'), n('751a')); var m = function(t, e) { return Object(d.a)({ method: 'get', url: '/v1_0/comments', params: { type: 'a', source: t, offset: e } }) }; var p = function(t, e) { return Object(d.a)({ method: 'post', url: '/v1_0/comments', data: { target: t, content: e } }) }; var f = function(t) { return Object(d.a)({ method: 'post', url: '/v1_0/comment/likings', data: { target: t } }) }; var v = function(t) { return Object(d.a)({ method: 'delete', url: '/v1_0/comment/likings/' + t }) }; var h = function(t, e) { return Object(d.a)({ method: 'get', url: '/v1_0/comments', params: { type: 'c', source: t, offset: e } }) }; var g = function(t, e, n) { return Object(d.a)({ method: 'post', url: '/v1_0/comments', data: { target: t, content: e, art_id: n } }) }; var b = function() { var t = this; var e = t.$createElement; var n = t._self._c || e; return n('div', { staticClass: 'article-comments' }, [n('van-nav-bar', { attrs: { title: t.currentComment.reply_count + '条回复' } }, [n('van-icon', { attrs: { slot: 'left', name: 'cross' }, on: { click: function(e) { return t.$emit('close') } }, slot: 'left' })], 1), n('van-cell', { attrs: { title: '当前评论' } }, [n('van-image', { staticStyle: { 'margin-right': '10px' }, attrs: { slot: 'icon', round: '', width: '30', height: '30', src: t.currentComment.aut_photo }, slot: 'icon' }), n('span', { staticStyle: { color: '#466b9d' }, attrs: { slot: 'title' }, slot: 'title' }, [t._v(t._s(t.currentComment.aut_name))]), n('div', { attrs: { slot: 'label' }, slot: 'label' }, [n('p', { staticStyle: { color: '#363636' } }, [t._v(t._s(t.currentComment.content))]), n('p', [n('span', { staticStyle: { 'margin-right': '10px' } }, [t._v(t._s(t._f('relative')(t.currentComment.pubdate)))]), n('van-button', { attrs: { size: 'mini', type: 'default' } }, [t._v('回复 ' + t._s(t.currentComment.reply_count))])], 1)]), n('van-icon', { attrs: { slot: 'right-icon' }, slot: 'right-icon' })], 1), n('van-divider', [t._v('全部回复')]), n('van-list', { attrs: { finished: t.finished, 'finished-text': '没有更多了' }, on: { load: t.onLoad }, model: { value: t.loading, callback: function(e) { t.loading = e }, expression: 'loading' } }, t._l(t.list, function(e, a) { return n('van-cell', { key: a }, [n('van-image', { staticStyle: { 'margin-right': '10px' }, attrs: { slot: 'icon', round: '', width: '30', height: '30', src: e.aut_photo }, slot: 'icon' }), n('span', { staticStyle: { color: '#466b9d' }, attrs: { slot: 'title' }, slot: 'title' }, [t._v(t._s(e.aut_name))]), n('div', { attrs: { slot: 'label' }, slot: 'label' }, [n('p', { staticStyle: { color: '#363636' } }, [t._v(t._s(e.content))]), n('p', [n('span', { staticStyle: { 'margin-right': '10px' } }, [t._v(t._s(t._f('relative')(e.pubdate)))])])])], 1) }), 1), n('van-cell-group', { staticClass: 'publish-wrap' }, [n('van-field', { attrs: { clearable: '', placeholder: '请输入回复内容' }, model: { value: t.content, callback: function(e) { t.content = typeof e === 'string' ? e.trim() : e }, expression: 'content' } }, [n('van-button', { attrs: { slot: 'button', size: 'mini', type: 'info' }, on: { click: t.addApply }, slot: 'button' }, [t._v('发布回复')])], 1)], 1)], 1) }; var _ = []; var k = { name: 'CommentReply', props: { currentComment: { type: Object, require: !0 }, articleId: { type: String, required: !0 } }, data: function() { return { list: [], loading: !1, finished: !1, content: '' } }, methods: { onLoad: function() { var t = this; return Object(i.a)(regeneratorRuntime.mark(function e() { var n, a; return regeneratorRuntime.wrap(function(e) { while (1) switch (e.prev = e.next) { case 0:return e.prev = 0, e.next = 3, h(t.currentComment.com_id.toString(), t.offset); case 3:n = e.sent, a = n.data.data.results, t.list = [].concat(Object(u.a)(t.list), Object(u.a)(a)), t.loading = !1, t.offset = n.data.data.last_id, a.length === 0 && (t.finished = !0), e.next = 14; break; case 11:e.prev = 11, e.t0 = e.catch(0); case 14:case 'end':return e.stop() } }, e, null, [[0, 11]]) }))() }, addApply: function() { var t = this; return Object(i.a)(regeneratorRuntime.mark(function e() { var n; return regeneratorRuntime.wrap(function(e) { while (1) switch (e.prev = e.next) { case 0:if (t.content !== '') { e.next = 2; break } return e.abrupt('return'); case 2:return e.next = 4, g(t.currentComment.com_id.toString(), t.content, t.articleId); case 4:n = e.sent, t.list.unshift(n.data.data.new_obj), t.currentComment.reply_count++, t.content = '', t.$toast.success('发布回复成功'); case 9:case 'end':return e.stop() } }, e) }))() } } }; var w = k; var x = (n('3afc'), n('2877')); var y = Object(x.a)(w, b, _, !1, null, '64b8df25', null); var C = y.exports; var j = { name: 'ArticleComment', components: { CommentReply: C }, props: { articleId: { type: String, require: !0 } }, data: function() { return { list: [], loading: !1, finished: !1, offset: null, content: '', isShowReply: !1, currentComment: {} } }, created: function() { this.onLoad() }, methods: { onLoad: function() { var t = this; return Object(i.a)(regeneratorRuntime.mark(function e() { var n, a; return regeneratorRuntime.wrap(function(e) { while (1) switch (e.prev = e.next) { case 0:return e.next = 2, m(t.articleId, t.offset); case 2:n = e.sent, a = n.data.data.results, t.list = [].concat(Object(u.a)(t.list), Object(u.a)(a)), t.loading = !1, a.length === 0 && (t.finished = !0), t.offset = n.data.data.last_id; case 8:case 'end':return e.stop() } }, e) }))() }, toggleCommentLike: function(t) { var e = this; return Object(i.a)(regeneratorRuntime.mark(function n() { var a; return regeneratorRuntime.wrap(function(n) { while (1) switch (n.prev = n.next) { case 0:if (n.prev = 0, a = t.com_id.toString(), !t.is_liking) { n.next = 8; break } return n.next = 5, v(a); case 5:e.$toast.success('取消喜欢成功'), n.next = 11; break; case 8:return n.next = 10, f(a); case 10:e.$toast.success('喜欢成功'); case 11:t.is_liking = !t.is_liking, n.next = 18; break; case 14:n.prev = 14, n.t0 = n.catch(0), e.$toast.fail('操作失败'); case 18:case 'end':return n.stop() } }, n, null, [[0, 14]]) }))() }, addComment: function() { var t = this; return Object(i.a)(regeneratorRuntime.mark(function e() { var n, a; return regeneratorRuntime.wrap(function(e) { while (1) switch (e.prev = e.next) { case 0:if (e.prev = 0, t.content !== '') { e.next = 3; break } return e.abrupt('return'); case 3:return e.next = 5, p(t.articleId, t.content); case 5:n = e.sent, a = n.data.data.new_obj, t.list.unshift(a), e.next = 13; break; case 10:e.prev = 10, e.t0 = e.catch(0), t.$toast.fail('该文章已关闭评论'); case 13:t.content = ''; case 14:case 'end':return e.stop() } }, e, null, [[0, 10]]) }))() }, clickShowReply: function(t) { this.isShowReply = !0, this.currentComment = t } } }; var S = j; var O = (n('9332'), Object(x.a)(S, s, l, !1, null, '490f4ba4', null)); var R = O.exports; var $ = { components: { ArticleComment: R }, name: 'ArticleIndex', props: { id: { type: String, require: !0 } }, data: function() { return { loading: !0, article: {} } }, created: function() { this.loadArticle() }, methods: { loadArticle: function() { var t = this; return Object(i.a)(regeneratorRuntime.mark(function e() { var n, a; return regeneratorRuntime.wrap(function(e) { while (1) switch (e.prev = e.next) { case 0:return e.next = 2, Object(c.f)(t.id); case 2:n = e.sent, a = n.data.data, t.article = a, t.loading = !1; case 6:case 'end':return e.stop() } }, e) }))() }, toggleFollow: function() { var t = this; return Object(i.a)(regeneratorRuntime.mark(function e() { return regeneratorRuntime.wrap(function(e) { while (1) switch (e.prev = e.next) { case 0:if (e.prev = 0, !t.article.is_followed) { e.next = 6; break } return e.next = 4, Object(o.f)(t.article.aut_id); case 4:e.next = 8; break; case 6:return e.next = 8, Object(o.a)(t.article.aut_id); case 8:t.article.is_followed = !t.article.is_followed, t.$toast.success('操作成功'), e.next = 15; break; case 12:e.prev = 12, e.t0 = e.catch(0), t.$toast.success('操作失败'); case 15:case 'end':return e.stop() } }, e, null, [[0, 12]]) }))() }, toggleLike: function() { var t = this; return Object(i.a)(regeneratorRuntime.mark(function e() { return regeneratorRuntime.wrap(function(e) { while (1) switch (e.prev = e.next) { case 0:if (t.article.attitude !== 1) { e.next = 6; break } return e.next = 3, Object(c.d)(t.article.art_id.toString()); case 3:t.article.attitude = -1, e.next = 9; break; case 6:return e.next = 8, Object(c.b)(t.article.art_id.toString()); case 8:t.article.attitude = 1; case 9:t.$toast.success('操作成功'); case 10:case 'end':return e.stop() } }, e) }))() }, toggleDislike: function() { var t = this; return Object(i.a)(regeneratorRuntime.mark(function e() { return regeneratorRuntime.wrap(function(e) { while (1) switch (e.prev = e.next) { case 0:if (t.article.attitude !== 0) { e.next = 6; break } return e.next = 3, Object(c.c)(t.article.art_id.toString()); case 3:t.article.attitude = -1, e.next = 9; break; case 6:return e.next = 8, Object(c.a)(t.article.art_id.toString()); case 8:t.article.attitude = 0; case 9:t.$toast.success('操作成功'); case 10:case 'end':return e.stop() } }, e) }))() } } }; var L = $; var z = (n('78d2'), Object(x.a)(L, a, r, !1, null, '4247e20a', null)); e.default = z.exports }, d1d2: function(t, e, n) {}, e2e6: function(t, e, n) {} }])
// # sourceMappingURL=chunk-1fbe24a6.dfd5ed3f.js.map
